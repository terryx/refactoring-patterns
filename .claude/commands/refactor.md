Apply refactoring patterns from specs/refactorings/ to improve code quality.

Review the code and:
1. Identify applicable refactoring patterns from specs/refactorings/
2. Apply the patterns following their mechanics
3. Ensure all changes follow the guidelines in .claude/CLAUDE.md

Focus on the most impactful improvements without requiring manual selection of specific patterns.
